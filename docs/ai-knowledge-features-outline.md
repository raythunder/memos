# AI 功能列表大纲（碎片化知识管理）

Last updated: 2026-02-15  
Owner: @raythunder

## 1. 文档目的

这份文档只用于**需求与实现讨论**，不直接进入开发。

- 先明确做什么、不做什么（KISS / YAGNI）。
- 先定义最小可落地范围（MVP）。
- 确保命名、数据模型、接口方向一致，再开始编码。

## 2. 术语与边界

为避免歧义，统一使用两条轴：

- `state`：状态（现有）  
  `NORMAL` / `ARCHIVED`
- `category`：知识分类（拟新增）  
  例：`idea` / `task` / `reference` / `review`

说明：

- “归档”是是否进入日常流。
- “分类”是这条内容属于哪类知识、该如何展示与处理。

## 3. 设计原则（本阶段）

- KISS：先做“自动整理 + 关联 + 找回”主链路。
- YAGNI：不做多 Agent 编排、不做复杂工作流引擎。
- DRY：复用现有 memo、search、settings、hook 框架。
- SOLID：把“提取/分类/关联/检索增强”拆成独立服务能力。
- Doc Sync：每个功能上线必须同步 plan/tracker/ops 文档。

## 4. 功能清单（讨论版）

## P0（优先）

### F1. 入库即整理（摘要 + 标签 + 分类建议）

- 用户价值：新 memo 不再“裸数据”，写完即有结构化信息。
- MVP 范围：
  - 自动生成 `summary`（1-2 句）。
  - 自动推荐 `tags`（3-5 个）。
  - 自动推荐 `category`（单选）。
  - 支持用户一键接受/覆盖。
- 非目标（YAGNI）：
  - 不做多版本摘要。
  - 不做复杂标签层级体系。
- 实现草图：
  - Backend：新增 AI 提取 service（异步任务，失败可重试）。
  - Data：memo metadata 增加 `summary/category/tags_source`（或扩展字段）。
  - Frontend：编辑器保存后展示“AI 建议卡片”。
- 验收指标：
  - 建议生成成功率。
  - 用户接受率（accept rate）。

### F2. 相似内容去重与合并建议

- 用户价值：减少重复记录，降低信息噪音。
- MVP 范围：
  - 基于语义向量召回相似 memo。
  - 超过阈值时提示“可能重复”。
  - 仅提供“手动合并建议”，不自动合并。
- 非目标：
  - 不做自动删除。
  - 不做跨用户合并。
- 实现草图：
  - 复用现有 embedding + semantic search。
  - 写入相似度结果缓存，降低重复计算。
- 验收指标：
  - 重复提醒触发准确性（人工抽样）。
  - 提醒后的合并/忽略比例。

### F3. 双向关联建议（Related Memos）

- 用户价值：写新 memo 时自动关联旧知识，形成知识网。
- MVP 范围：
  - 每条 memo 展示 TopN 相关记录。
  - 用户可“确认关联/忽略”。
  - 支持在详情页查看关联链路。
- 非目标：
  - 不做图谱可视化编辑器。
- 实现草图：
  - 后端提供 `ListRelatedMemos`（可由语义召回 + 权限过滤）。
  - 复用现有 memo relation 存储能力（若字段不足再扩展）。
- 验收指标：
  - 相关建议点击率。
  - 关联被确认的比例。

## P1（次优）

### F4. 自动提取任务（Action Items）

- 用户价值：把“想法文字”转成“可执行事项”。
- MVP 范围：
  - 从 memo 中提取任务项（标题、可选截止时间）。
  - 一键转换为 checklist 或独立任务 memo。
- 非目标：
  - 不做完整项目管理模块。
- 实现草图：
  - 提取结果结构化（JSON schema）。
  - 与现有 task list 能力对齐。
- 验收指标：
  - 提取后任务被保留/完成比例。

### F5. 主题聚类与周报

- 用户价值：每周自动回顾“我这周到底在想什么”。
- MVP 范围：
  - 周维度聚类（3-6 个主题）。
  - 每个主题输出摘要与代表 memo。
  - 输出“未闭环问题”列表。
- 非目标：
  - 不做长周期趋势 BI 面板。
- 实现草图：
  - 定时任务 + 摘要聚合。
  - 结果写入一个只读周报资源。
- 验收指标：
  - 周报打开率。
  - 用户标记“有帮助”的比例。

## P2（增强）

### F6. 混合检索（关键词 + 语义）与命中解释

- 用户价值：提升召回，同时让结果“可解释”。
- MVP 范围：
  - 混合分数排序（关键词 + 语义）。
  - 返回“命中原因”短文案（关键词命中/语义接近）。
- 非目标：
  - 不做复杂 reranker 管道。
- 实现草图：
  - 保留现有 `ListMemos` / `SearchMemosSemantic`，新增融合层。
- 验收指标：
  - 搜索成功率（用户首屏找到目标）。
  - 无结果率下降幅度。

### F7. 写作时上下文召回

- 用户价值：减少遗忘，避免重复写相同内容。
- MVP 范围：
  - 编辑器输入到一定长度后触发“你可能在找这些历史记录”。
- 非目标：
  - 不做实时 token 级联想。
- 实现草图：
  - 前端节流请求 + 后端语义召回。
- 验收指标：
  - 建议点击率。

### F8. 冲突与过期提醒

- 用户价值：减少“过时知识”和“互相矛盾结论”。
- MVP 范围：
  - 标记高引用但长时间未更新的 memo。
  - 标记可能冲突的结论对（仅提醒，不自动判定真伪）。
- 非目标：
  - 不做自动裁决。
- 实现草图：
  - 基于时间、引用关系、语义对比进行低频批处理。
- 验收指标：
  - 被确认为有效提醒的比例。

## 5. 建议开发顺序

1. Phase A：F1 + F2 + F3（先解决“录入结构化 + 去重 + 关联”）
2. Phase B：F4 + F5（形成“采集 -> 执行 -> 复盘”闭环）
3. Phase C：F6 + F7 + F8（搜索增强与知识治理）

## 6. MVP 技术约束（讨论前提）

- 默认沿用现有栈（Go + Postgres + React + 现有 OpenAI 配置路径）。
- 默认不引入新第三方库；如确有必要，需单独评审。
- AI 请求统一走现有设置中心（`Settings -> AI`）与审计日志策略。
- 所有异步 AI 任务必须可重试、可观测、可降级。

## 7. 需你确认的问题（进入开发前）

1. `category` 的初始枚举是否采用：`idea/task/reference/review`？
2. F1 的触发时机：保存后异步刷新，还是保存前同步阻塞？
3. F2 相似阈值：是否先固定阈值，再逐步引入可配置？
4. F3 关联结果是否允许用户手动置顶/屏蔽？
5. F4 任务转换是写回原 memo checklist，还是新建子 memo？
6. 周报（F5）是否需要多人共享，还是先仅个人可见？
7. 是否先只做英文/中文双语提示，不做更多本地化？
8. 指标采集是否允许记录匿名行为事件（用于验收指标）？

## 8. 讨论后的交付物（下一步）

确认本大纲后，再产出：

- `plan`：里程碑、范围、验收标准。
- `tracker`：任务拆解、状态、风险。
- `api/design`：字段、接口、迁移与回滚策略。
